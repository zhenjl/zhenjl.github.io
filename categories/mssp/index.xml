<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
      <title>Mssp on Zen 3.1 </title>
      <generator uri="https://hugo.spf13.com">Hugo</generator>
    <link>http://zhen.org/categories/mssp/index.xml/</link>
    <language>en-us</language>
    <author>Jian Zhen</author>
    <copyright>Jian Zhen</copyright>
    <updated>Mon, 29 Nov 2004 02:44:45 &#43;0000</updated>
    
    <item>
      <title>Log Management Requirements for MSPs</title>
      <link>http://zhen.org/blog/log-management-requirements-for-msps/</link>
      <pubDate>Mon, 29 Nov 2004 02:44:45 &#43;0000</pubDate>
      <author>Jian Zhen</author>
      <guid>http://zhen.org/blog/log-management-requirements-for-msps/</guid>
      <description>

&lt;p&gt;I spent five years at one of the largest MSSPs as an architect and development manager. We had a couple thousand firewall, VPN, NIDS and HIDS devices that we manage for various hosting and managed service customers. We needed to aggregate all the logs generated by these devices and be able to provide reports and analysis for our customers.&lt;/p&gt;

&lt;p&gt;We spent quite a bit of time looking at various COTS products and services, including &lt;a href=&#34;http://www.arcsight.com&#34;&gt;ArcSight&lt;/a&gt;, &lt;a href=&#34;http://www.intellitactics.com&#34;&gt;Intellitactics&lt;/a&gt;, &lt;a href=&#34;http://www.netforensics.com&#34;&gt;netForensics&lt;/a&gt;, and others. However, none met our requirements.&lt;/p&gt;

&lt;p&gt;At the end, we built our own solution using open source tools such as MySQL, GD::Graph, RRD Tool, Cricket, etc.&lt;/p&gt;

&lt;p&gt;Below are the top ten requirements that any MSP should consider when building their log management solution.&lt;/p&gt;

&lt;h3 id=&#34;toc_0&#34;&gt;1. Segregation of Logs by Customer&lt;/h3&gt;

&lt;p&gt;As an MSSP, one of the biggest concern we had was the segregation of logs for the many customers we had. We didn&amp;rsquo;t want any of the customer data to be mixed in the same files or database tables as other customers. This requirement drove many of the design decisions we made during the building of the support infrastructure.&lt;/p&gt;

&lt;p&gt;Imagine two competitors had their firewalls managed by the MSP and their data were mixed in the same files, what happens if the data of one competitor were shown to the other because of a bug in the software that&amp;rsquo;s used to filter logs?&lt;/p&gt;

&lt;h3 id=&#34;toc_1&#34;&gt;2. Raw Log Retention Is Required&lt;/h3&gt;

&lt;p&gt;One of the requirements we had was that we needed to provide the raw logs to our customers so that they can do their own analysis. We can do all the necessary analysis on our side, but sometimes the customers may want other information from the logs that we don&amp;rsquo;t. Also, customers sometime have information that are proprietary and they can use that information to correlate with the logs.&lt;/p&gt;

&lt;p&gt;Remember, MSPs built everything based on scale of economy and sometimes it&amp;rsquo;s difficult to customize the solution for individual customers. Obviously if the customer wanted to pay for professional services, there&amp;rsquo;s customization we can do. But not every customer wants to or have the budget to do that.&lt;/p&gt;

&lt;h3 id=&#34;toc_2&#34;&gt;3. Reporting is #1&lt;/h3&gt;

&lt;p&gt;Customers wanted to reports on their security infrastructure. They wanted to see how much traffic (bytes, connections, etc) the firewalls are passing so they can properly plan for the future. They wanted to see how often users are VPN&amp;rsquo;ing into the infrastructure so they can identify any mis-use. They want to see trend reports to show how their infrastructure is holding up. They wanted to see correlated reports of the various devices (firewalls, VPN, IDS, etc) to see if there are any anomalies.&lt;/p&gt;

&lt;p&gt;Our #1 priority was to provide all these reports and more to our customers.&lt;/p&gt;

&lt;h3 id=&#34;toc_3&#34;&gt;4. Then Comes Real-Time Analysis/Alerting&lt;/h3&gt;

&lt;p&gt;Alerting is another important feature that our customers wanted. They wanted to know when something really bad is happening to their infrastructure. They don&amp;rsquo;t want to get alerted every time some script kiddie scans their network, but they do want to know if their network all the sudden has a huge increase in traffic and continues to increase for a long period of time. They want to know when an unauthorized connection is made to their production database. They want to know when a successful attack has been happened.&lt;/p&gt;

&lt;p&gt;However, the MSPs are the first to receive these alerts and will filter the alerts based on the internal knowledge and SLA. Then the MSP will pass the alerts onto the customer if they are determined to be real.&lt;/p&gt;

&lt;h3 id=&#34;toc_4&#34;&gt;5. Support All My Log Sources&lt;/h3&gt;

&lt;p&gt;Most MSPs support an array of devices and applications as part of their service. For examples, most MSPs will support firewalls such as PIX, Netscreen, Check Point or IP Tables, Network IDSes such as ISS or Cisco, Host-based IDS such as ISS, Okena, or Trip Wire. Some MSPs will support SSL accelerators or proxies, vulnerability scanning tools, servers, and many other applications.&lt;/p&gt;

&lt;p&gt;At Cable &amp;amp; Wireless, we had firewalls, Network or Host based IDSes, scanning tools and authentication services. We needed a solution that will support all these different devices or applications. Most of the logs are sent via syslog except for Check Point firewall, Cisco IDS and Nessus scanning results. The Check Point logs were aggregated at the Provider-1 boxes and they need to be off loaded using LEA. The Cisco IDS alerts need to be retrieved via RDEP. The Nessus scan results were XML files and they needed to be parsed.&lt;/p&gt;

&lt;h3 id=&#34;toc_5&#34;&gt;6. Web-based GUI Only&lt;/h3&gt;

&lt;p&gt;We needed a web-based GUI so that the customers can access reports, alerts, raw logs and device policies. It&amp;rsquo;s difficult to support any GUI that requires installation on the customer&amp;rsquo;s desktop. Non-web applications will eventually have conflicts with other applications and will require support from the MSP. That model is not scalable.&lt;/p&gt;

&lt;p&gt;We also needed to embed this interface in our own web based interface. It is much easier to embed another web interface than an application. It is also much easier to skin a web interface as we wanted to have our corporate color scheme and logos there.&lt;/p&gt;

&lt;h3 id=&#34;toc_6&#34;&gt;7. Distributed Collection Points&lt;/h3&gt;

&lt;p&gt;Cable &amp;amp; Wireless had over 40 data centers all over the world. Most MSPs probably have distributed environments as well. The devices that we managed were spread all over the data centers. They can be in UK or NY or SF or even HK or Japan. We needed a solution that can collect logs in all these different locations. We needed to be able to collect logs close to the log source so that the chance of dropped logs is minimized. We also wanted to keep the cost of these remote collectors relatively low comparing to the central archive.&lt;/p&gt;

&lt;h3 id=&#34;toc_7&#34;&gt;8. Secure Connections All The Way&lt;/h3&gt;

&lt;p&gt;As a security organization, everything we did that can be secured must be secured. Unfortunately we cannot secure protocols such as syslog from a PIX, but we must support SSL for the web interface, Cisco RDEP, Check Point LEA, and encryption between remote collectors and the central storage. We also needed to secure the connection between the database and other components if they are in different networks.&lt;/p&gt;

&lt;h3 id=&#34;toc_8&#34;&gt;9. No Agents Whatsoever&lt;/h3&gt;

&lt;p&gt;Due to the risk (performance, application conflicts, etc) of installing additional software (custom agents) on servers, we needed a solution that doesn&amp;rsquo;t require agents. This requirement is generally not a problem for most devices since they send logs via syslog. However, it&amp;rsquo;s a big issue for Windows based operating systems. There are several methods that one can collect Windows events, as I have written &lt;a href=&#34;http://www.trustpath.com/logmatters/index.php?p=9&#34;&gt;previously&lt;/a&gt;. However, all these methods have their problems such as requirements of agents or performance issues or none-real-time logging. Since we didn&amp;rsquo;t manage many Windows devices, this was not our major concern.&lt;/p&gt;

&lt;h3 id=&#34;toc_9&#34;&gt;10. Open API for Integration&lt;/h3&gt;

&lt;p&gt;Another requirement was that we needed to run reports or search logs via scripts or web applications. We ran many background processes that sent out reports to customers or create custom reports based on some other condition. All these needed to be automated due to the need for scale of economy. This required that the solution to provide some type of open API that can be used within other programs.&lt;/p&gt;

&lt;h3 id=&#34;toc_10&#34;&gt;11. Granular Permission Model&lt;/h3&gt;

&lt;p&gt;Since we needed to provide alerts, reports and raw logs to customers, we need to make sure customers have access to ONLY their own information. It was critical that customers don&amp;rsquo;t see other customers&amp;rsquo; data. We needed the solution to have a granular permission model that can determine which devices belong to which customer, which reports the customers/users can see, which log files can be viewed by customers, etc.&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;These are some of the requirements for an MSP. I hope this will help you evaluate and build your own log management infrastructure.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Pros and Cons of MSSPs</title>
      <link>http://zhen.org/blog/pros-and-cons-of-mssps/</link>
      <pubDate>Fri, 19 Nov 2004 09:39:12 &#43;0000</pubDate>
      <author>Jian Zhen</author>
      <guid>http://zhen.org/blog/pros-and-cons-of-mssps/</guid>
      <description>

&lt;p&gt;We will be a bit off topic today as I am thinking about a few-parts blog on MSSPs. Today we will discuss the pros and cons of outsourcing to a MSSP.&lt;/p&gt;

&lt;p&gt;There are many reasons why outsourcing sometimes is a cheaper and better way to go. Note that I said &amp;ldquo;sometimes&amp;rdquo;, because everything depends on your requirement. If your requirement is that every security device must be in house and only 2 Admin will have access to them, then outsourcing is not for you. So first thing you need to do is document your requirements.&lt;/p&gt;

&lt;h3 id=&#34;toc_0&#34;&gt;Pros&lt;/h3&gt;

&lt;p&gt;So here are some reasons why I think outsourcing is an option.&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Cost - MSSPs can get much better deals from vendors than you can on your own. So the cost of hardware and software will be cheaper. Let&amp;rsquo;s do some simple calculations, if you decide to firewalls inhouse, the cost of a pair of  PIX 525 retail + maintenance is about $20k. The cost of a dedicated security engineer + training will cost you atleast $110k (low figure as I have not added corporate overhead, which could be another 30-40%). Take that over 3 years (that&amp;rsquo;s usually how long the companies will depreciate equipment.) That gives you about $10k/month. You can get it for much cheaper with an MSSP. Generally you can get a decent SLA for $1-2K/month. Over three years, that&amp;rsquo;s quite a big of savings!&lt;/li&gt;
&lt;li&gt;Hardware Upgrades - This section maybe different for different MSSPs, so be sure to ask if you are looking to outsource. Basically, hardware gets obsolete very quickly. If you buy your own hardware, in 3 years, you will have to spend money upgrading. The original investment you made is now paper weight. But if you go with an MSSP, you can get the hardware upgrade for free. For example, let&amp;rsquo;s say Nokia decides to upgrade their IP350 platform from the current processor to a faster one, the MSSP will be able to upgrade you for free where as you would have to spend money on your own.&lt;/li&gt;
&lt;li&gt;Software Upgrades - Same as hardware here. You can get software upgrades for free with a MSSP where as you might have to pay your own way. For example, from Check Point 4.1 to Check Point NG AI.&lt;/li&gt;
&lt;li&gt;Vendor Support - Because MSSPs buy so many equipment/software from vendors, they have much better support from them also. They usually have dedicated support from these vendors 24x7. So any problem that arises will get to the right people immediately, instead of having to go through the normal channels. MSSPs can also get patches/fixes/updates much faster as well. If needed, sometimes vendors are willing to cut an engineering release to fix a HOT problem. Now not all MSSPs have the same support contract with vendors, so buyers beware.&lt;/li&gt;
&lt;li&gt;24x7 Support - We are not talking about somebody carrying a pager here, we are talking about having trained security engineers awake and doing work any hour of the day. This is one of the biggest advantages for outsourcing. Scale of economy plays a huge role here. The MSSPs can have dedicated engineers working 24x7 whereas you might have your guys waking up in the middle of the night, all grumpy, to fix some problems.&lt;/li&gt;
&lt;li&gt;Expertise/Experience - Because the MSSPs work with firewalls/VPNs/IDS all the time, it is much more likely that they will have encountered the problem that you are experiencing. In this situations, the MSSP may be able to fix you problem in 30 mins, whereas you may have to spend hours figuring out what happened and try to fix it.&lt;/li&gt;
&lt;li&gt;Software Patches - This is perhaps one of the biggest issues with security nowadays. Many organizations simply don&amp;rsquo;t have the resource or time to keep up with all the security patches or updates on their security devices. The MSSPs will HAVE to do that as part of their SLA. Again, this is where scale of economy plays a big part in. The MSSPs can upgrade all of their security devices such as firewall or VPN with the appropriate patches when they receive it from the vendors (usually sooner because of their relationships).&lt;/li&gt;
&lt;li&gt;Training - Most of the MSSPs require their engineers to be trained on the devices they service, and they are willing to spend the money to get them trained. Training is certainly not cheap, a PIX or Firewall-1 course can cost anywhere from $3k - $5k. Many of the engineers are also experienced in designing complex &amp;amp; secure networks. I for one am not very fond of certifications (even though I carry a couple). I think anyone with half of a brain can pass the certification exams, for example. So when/if you are looking for an outsourcer, beware of anyone telling you that all their engineers are certified. It really doesn&amp;rsquo;t mean jack. Certifications provide some value, but not a whole lot. It is the hands-on training and experience that count the most.&lt;/li&gt;
&lt;li&gt;Spare Equipment - This again is another huge value MSSPs can provide at very little or no cost to you. Because MSSPs manage so many equipment, they cannot wait for vendors to ship them spare equipment when something dies, so they have extra equipment ready to deploy. And trust me, equipment do die. :)&lt;/li&gt;
&lt;li&gt;Security Monitoring - One of the hottest topic in the security space is obviously log analysis and management. Many vendors have some type of event correlation engine or tool they are using to help you monitor your network. For example,  NetSec uses the neuSecure product of independent software maker, Guarded.Net; Symantec acquired the correlation engine of Cyberwolf and RipTech; Savvis, Ubizen and others have their own home-grown solutions. Again, depending on the MSSP, you may have to pay extra for this service or you may get it as part of your SLA.&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&#34;toc_1&#34;&gt;Cons&lt;/h3&gt;

&lt;p&gt;However, there are some disadvantages to outsourcing as well. Here are the reasons why you should think twice before outsourcing.&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Device control - Once you outsource your security infrastructure such as firewalls and IDS, you may lose some or all control of the devices. Many MSSPs want to retain full control in order to reduce the finger pointing when catastrophe happens. Also, MSSPs usually have tools and infrastructure that will manage the devices differently than individual administrators, so shared control can create problems when both sides cannot agree on certain things. However, you still have control of the policies of the devices. If you cant swallow the fact that you will lose control, look for a MSSP that will share access with you.&lt;/li&gt;
&lt;li&gt;Security policy - Any good security policy requires the knowledge on the companys corporate culture and business. The MSSP will not know everything about your company. For example, they wont know that your companys extranet can only be accessed by specific strategic partners; nor do they know that only specific adminitrators can access security data and these people must have access at anytime. It is your responsibility of working with the MSSP to make sure that they understand and build your security policy. Some MSSPs can provide professional services to help you but the downside is that you will have to pay more.&lt;/li&gt;
&lt;li&gt;Security environment - Unless the MSSP handles all of your infrastructure, they wont know all the applications and servers you have. This means that it is difficult for them to accurate determine whether a security event is critical or just a false alarm due to the insufficient information. Most MSSPs can work with you to setup a escalation policy that would include partial knowledge of your environment, including what applications and servers in your infrastructure. However, it is up to you to keep that information current and update the MSSP as necessary.&lt;/li&gt;
&lt;li&gt;Administrative access - One of the biggest surprises for companies considering outsourcing is that most MSSPs will have a team of engineers who all have administrative access to their devices. The team size can sometimes be as many as 30 engineers! In contrast, most companies probably have only 2 to 3 administrators who are allowed to manage the devices. To mitigate the risk of having too many people who can modify the device, work with the MSSP to make sure they know whom from your company can request changes. Keep the number of people who can request changes to a number you are comfortable with.&lt;/li&gt;
&lt;li&gt;Response time - Most MSSPs will have a very fast response time when it comes to catastrophes. For example, if the device goes down due to hardware or software failure, the response time to get on the case is usually about 15 minutes. However, if you need a policy change quickly, the response time can be in the order of 6 to 24 business hours depending on the SLA.  This generally requires the company to plan ahead when working on projects. It also means dont send in a change request to open a port on the firewall two hours before you need it.&lt;/li&gt;
&lt;li&gt;Customization - MSSPs are all about economies of scale. All their operations are based on that concept in order to make a profit. Their preference is to perform any task on a mass scale so nothing needs customization. The downside, of course, is that your devices will be managed just like any other device. If you have specific requirements that need customization by the MSSP, it will be difficult to convince them to do so as it breaks their model. For example, it will be difficult to convince the MSSP to enable SNMP on your firewall if the MSSPs policy doesnt allow that.&lt;/li&gt;
&lt;li&gt;Financial viability - This perhaps is one thing that most companies will ignore or not spend enough time when it comes to due diligence. To identify the MSSP that meets your requirements, not only do you need to spend time on the SLA and technical requirements, it is critical to understand the MSSPs business and financial viability. Given that many of the MSSPs are there are fairly small and new to the business, any risky business move on the parts of the MSSP can put them out of business. As we have seen over the years, many of them did. Remember Pilot Networks and how much time they gave their customers when they went out of business?&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Now that we have gone through the many pros and cons of outsourcing to MSSPs, it is up to you to understand your requirements and figure out whether to outsource or not. Make sure you ask all the questions and spend time on due diligence, and dont let the MSSP talk you into something that you are not sure about. Make sure you talk to multiple MSSPs and understand how they can meet your requirements. In other words, do your research first.&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>